### 服务提供者
- 服务注册：服务提供者在启动时会发送REST请求将自己注册到Eureka server上，同时会带上自己的一些元数据信息，如可访问的url。Eureka server会将其存放
在一个双层map中，第一层key为服务名，第二层key为具体服务的实例名（注册中心互相注册，一个服务有多个实例）。
- 服务同步：两个服务提供者分别注册到两个不同的服务注册中心上，而两个注册中心互相注册，当服务提供者发送一个注册请求到其中一个注册中心时，它会将该请求转发
到另一个注册中心，从而实现注册中心之间的同步，通过服务同步，两个服务提供者的服务信息就可以通过两个注册中心中的任意一个得到。
- 服务续约：当服务注册到注册中心后，服务提供者会维护一个心跳告诉注册中心自身的状态，防止被注册中心剔除，可以通过以下属性进行服务续约的设置：
```# 每30秒发送心跳告诉服务注册中心自己还活着
 eureka.instance.lease-renewal-interval-in-seconds=30
 # 注册中心90秒内没有收到心跳就进行服务剔除
 eureka.instance.lease-expiration-duration-in-seconds=90
```
### 服务消费者
- 获取服务：启动服务消费者时会从注册中心获取一份只读的服务清单，Eureka server每隔30秒进行更新
- 服务调用：服务消费者在获取了具体的服务提供者的服务实例名和元数据信息后，可以使用Ribbon进行调用。访问的实例选择有Region和Zone概念，一个Region下
有多个Zone,一个客户端对应一个Zone,一个Region有多个Zone,在选择实例时会优先使用同一个Zone下的实例，如果访问不到，则尝试访问其他Zone
- 服务下线：在对一个服务进行关闭时，会发送一个Rest请求到Eureka server,告诉服务注册中心我要下线了，注册中心在收到请求之后会将该服务设置为DOWN,并把
事件传播出去
### 服务注册中心
- 失效剔除：将服务注册中心在规定时间内没有收到服务续约的请求，并且没有收到下线请求，则会将该服务剔除。
- 自我保护：Eureka server会统计15分钟之内服务续约的心跳请求失败率是否低于85%，如果低于则会将服务注册信息保护起来，让这些实例不会过期。此时客户端很
容易拿到已经不存在的服务，所以客户端需要容错机制，如请求重试、断路器等。

